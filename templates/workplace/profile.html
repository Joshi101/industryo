{% extends "base.html" %}

{% load staticfiles %}
{% load bootstrap %}

{% block title %} CoreLogs | {{ workplace.name }} {% endblock title %}

{% block left %}
	<div id="img_profile_box" typeof='Organization' resource='#workplace'>
		<img id="img_profile" class="thumbnail" width="120" height="120" src="{{workplace.get_logo}}" property='logo' typeof='ImageObject'>
    {% if user == request.user %}
    <a id='img_upload' class="text-center" data-toggle='modal' data-target='#img_upload_modal'>Change Image</a>
    {% endif %}
  </div>
	<div class="account">
	</div>
	{% include "snippets/img_upload_modal.html" with url='nodes:set_logo' form=workplace_logo_form.image %}
{% endblock left %}

{% block content %}
  <div id="workplace_info" class="row" typeof='Organization' resource='#workplace'>
    <div class="col-sm-7">
      <h4 class=" text-uppercase" property='name'>{{ workplace.name }}</h4>
      <h4 class="text-muted ajax_andar ajax_papa" property='location' typeof='PostalAddress'>
        <small><i class="tag_container" property='addressRegion'>{% include "snippets/area.html" with workplace=workplace %}</i></small>
      </h4>
      <h4 class="text-muted ajax_andar ajax_papa">
        <small><b><i class="tag_container">{% include "snippets/segment.html" with workplace=workplace %}</i></b></small>
      </h4>
    </div>
    <div class="col-sm-offset-1 col-sm-4">
      <h5><span class="label label-default">{{workplace.points}} points</span></h5>
      <h5><span class="label label-success"><span property='numberOfEmployees'>{{ member_count }}</span> members</span></h5>
    </div>
  </div>
  <ul class="nav nav-pills">
  {% block workplace_nav %}
    <li><a href="{% url "workplace:products" workplace.slug %}">Products</a></li>
    <li><a href="{% url "workplace:members" workplace.slug %}">Members</a></li>
    <li><a href="{% url "workplace:capabilities" workplace.slug %}">Capabilities</a></li>
    <li><a href="{% url "workplace:about" workplace.slug %}">About</a></li>
    <li class="active"><a href="{% url "workplace:workplace_profile" workplace.slug %}">Dashboard</a></li>
  {% endblock workplace_nav %}
  </ul>
  <div class="tab-content ajax_papa ajax_andar">
  {% block workplace_section %}
    <div id="dashboard" class="tab-pane fade in active">
      {% include "workplace/snip_dashboard.html" with workplace=workplace questions=questions answers=answers feeds=feeds articles=articles %}
    </div>
  {% endblock workplace_section %}
  </div>
{% endblock %}

{% block right %}
  <div class="floating_form">
    <h5 class="side_head">Most Active Members</h5>
    <ul id="top_members" class="ppl_list">
    </ul>
  </div>
  {% comment %}
  {% ifequal user.userprofile in members %}
    {% include "snippets/floating_form.html" with tag="material" type="M" %}
    {% include "snippets/floating_form.html" with tag="operation" type="O" %}
    {% include "snippets/floating_form.html" with tag="asset" type="A" %}
  {% endifequal %}
  {% endcomment %}
  <script type="text/javascript">
    $(document).ready(function(){
      get_top_scorers();
    });
    function get_top_scorers(){
      $.ajax({
        url: "{% url "workplace:get_top_scorers" workplace.slug %}",
        type: 'GET',

        success: function(response){
            $('#top_members').html(response);
        },
        error : function(xhr,errmsg,err) {
            console.log(errmsg,err);
        }
      });
    }
  </script>
{% endblock right %}